{"version":3,"sources":["main.js"],"names":["el","string","document","querySelector","section","main","canvas","currentColor","thickness","brushColor","type","text","vh","window","innerHeight","style","setProperty","mainWidth","parseInt","clientWidth","mainHeight","clientHeight","width","height","ctx","getContext","strokeStyle","value","fillStyle","lineWidth","lineJoin","painting","lastX","lastY","addEventListener","e","offsetX","offsetY","beginPath","arc","Math","PI","closePath","fill","moveTo","lineTo","stroke","touches","pageX","target","offsetLeft","pageY","offsetTop","body","matches","preventDefault","passive","color16","color","getComputedStyle","backgroundColor","matchAll","forEach","item","str","toString","length","li","parentNode","childNodes","node","classList","remove","undefined","add","Array","from","indexOf","textContent","globalCompositeOperation"],"mappings":"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","file":"main.d3223fd5.js","sourceRoot":"..\\src","sourcesContent":["const el = (string) => document.querySelector(string);\n\nconst section = el(\"section\");\nconst main = el(\"main\");\nconst canvas = el(\"#canvas\");\nconst currentColor = el(\".currentColor\");\nconst thickness = el(\".thickness\");\nconst brushColor = el(\".brushColor\");\nconst type = el(\".type\");\nconst text = el(\".text\");\n\n// 优化移动端浏览器工具栏高度包含于100vh的问题，将浏览器真正视口高度作为 section 样式高度\nlet vh = window.innerHeight * 0.01;\nsection.style.setProperty(\"--vh\", `${vh}px`);\n// 设置画布宽高及样式宽高（不设置样式宽高会被 flex-grow 拉长）\nconst mainWidth = parseInt(main.clientWidth * 0.8);\nconst mainHeight = parseInt(main.clientHeight * 0.9);\ncanvas.width = `${mainWidth}`;\ncanvas.height = `${mainHeight}`;\ncanvas.style.width = `${mainWidth}px`;\ncanvas.style.height = `${mainHeight}px`;\n\nconst ctx = canvas.getContext(\"2d\");\nctx.strokeStyle = currentColor.value;\nctx.fillStyle = currentColor.value;\nctx.lineWidth = thickness.value;\nctx.lineJoin = \"round\";\nlet painting = false;\n// 上一个绘画路径点的坐标\nlet lastX = 0;\nlet lastY = 0;\n\n// 鼠标绘图\ncanvas.addEventListener(\"mousedown\", (e) => {\n  painting = true;\n  lastX = e.offsetX;\n  lastY = e.offsetY;\n  ctx.beginPath();\n  ctx.arc(lastX, lastY, ctx.lineWidth / 2, 0, 2 * Math.PI);\n  ctx.closePath();\n  ctx.fill();\n});\ncanvas.addEventListener(\"mousemove\", (e) => {\n  if (painting) {\n    ctx.beginPath();\n    ctx.moveTo(lastX, lastY);\n    ctx.lineTo(e.offsetX, e.offsetY);\n    ctx.closePath();\n    ctx.stroke();\n    lastX = e.offsetX;\n    lastY = e.offsetY;\n  }\n});\ncanvas.addEventListener(\"mouseup\", (e) => {\n  painting = false;\n});\n// 鼠标移出画布停止绘画，防止再次进入产生连线\ncanvas.addEventListener(\"mouseout\", (e) => {\n  painting = false;\n});\n// 触摸绘图\ncanvas.addEventListener(\"touchstart\", (e) => {\n  painting = true;\n  lastX = e.touches[0].pageX - e.touches[0].target.offsetLeft;\n  lastY = e.touches[0].pageY - e.touches[0].target.offsetTop;\n  ctx.beginPath();\n  ctx.arc(lastX, lastY, ctx.lineWidth / 2, 0, 2 * Math.PI);\n  ctx.closePath();\n  ctx.fill();\n});\n// 使用事件委托优化移动端绘图，在画布上触摸移动时阻止body默认事件（阻止浏览器的滑动）\ndocument.body.addEventListener(\n  \"touchmove\",\n  (e) => {\n    if (painting && e.target.matches(`canvas`)) {\n      e.preventDefault();\n      ctx.beginPath();\n      ctx.moveTo(lastX, lastY);\n      ctx.lineTo(\n        e.touches[0].pageX - e.touches[0].target.offsetLeft,\n        e.touches[0].pageY - e.touches[0].target.offsetTop\n      );\n      ctx.closePath();\n      ctx.stroke();\n      lastX = e.touches[0].pageX - e.touches[0].target.offsetLeft;\n      lastY = e.touches[0].pageY - e.touches[0].target.offsetTop;\n    }\n  },\n  { passive: false }\n);\ncanvas.addEventListener(\"touchend\", (e) => {\n  painting = false;\n});\n// 触摸移出画布停止绘画，防止再次进入产生连线\ncanvas.addEventListener(\"touchcancel\", (e) => {\n  painting = false;\n});\n\ncurrentColor.addEventListener(\"input\", (e) => {\n  ctx.strokeStyle = e.target.value;\n  ctx.fillStyle = e.target.value;\n});\nthickness.addEventListener(\"input\", (e) => {\n  ctx.lineWidth = parseInt(e.target.value);\n});\n// 点击色块改变画笔颜色，将色块背景色赋值给 currentColor.value （RGB 转为 HEX ）\nbrushColor.addEventListener(\"click\", (e) => {\n  if (e.target.matches(\"li\")) {\n    let color16 = \"#\";\n    const color = getComputedStyle(e.target).backgroundColor;\n    [...color.matchAll(/\\d{1,3}/g)].forEach((item) => {\n      const str = parseInt(item).toString(16);\n      color16 += str.length === 2 ? str : \"0\" + str; // 确保六位数 HEX 颜色值\n    });\n    ctx.strokeStyle = color16;\n    ctx.fillStyle = color16;\n    currentColor.value = color16;\n  }\n});\n// 点击图标切换铅笔橡皮，使用 globalCompositeOperation 设置绘图类型\ntype.addEventListener(\"click\", (e) => {\n  if (e.target.matches(\"img\")) {\n    const li = e.target.parentNode;\n    type.childNodes.forEach((node) =>\n      node.classList ? node.classList.remove(\"selected\") : undefined\n    );\n    li.classList.add(\"selected\");\n    if (Array.from(li.classList).indexOf(\"eraser\") >= 0) {\n      text.textContent = \"橡皮\";\n      ctx.globalCompositeOperation = \"destination-out\";\n    } else {\n      text.textContent = \"铅笔\";\n      ctx.globalCompositeOperation = \"source-over\";\n    }\n  }\n});\n"]}